# TRON地址后缀匹配生成说明

## 功能说明

系统现已支持生成后5位相同的TRON地址，使用profanity-tron工具实现。

## 实现原理

1. **使用profanity-tron**：专门的TRON地址生成工具，支持后缀匹配
2. **匹配模式**：使用`--matching`参数指定模式，`X`表示任意字符
3. **后缀长度**：使用`--suffix-count 5`指定匹配后5位

## 示例命令

```bash
profanity --matching TXXXXXXXXXXXXXXX11111 --suffix-count 5 --quit-count 1
```

这会生成一个后5位为`11111`的TRON地址。

### 地址格式规则（20字符）
- 总长度：20个字符（推荐格式）
- 格式：`T + 中间任意字符（X） + 想要的后缀`
- 例子：
  - 后5位11111：`TXXXXXXXXXXXXXXX11111`（T + 15个X + 5个1）
  - 后6位BBBBBB：`TXXXXXXXXXXXXXBBBBBB`（T + 14个X + 6个B）
  - 后4位1234：`TXXXXXXXXXXXXXXXX1234`（T + 16个X + 4个数字）

### 地址格式规则（34字符）
- 总长度：34个字符（完整地址长度）
- 格式：`T + 中间任意字符（X） + 想要的后缀`
- 例子：
  - 后5位11111：`TXXXXXXXXXXXXXXXXXXXXXXXXXXXXX11111`（T + 29个X + 5个1）

注意：profanity已经注册为全局命令，可以在任何目录下直接使用。

## 代码修改

在`app/utils/vanitygen_plusplus.py`中：

1. 新增了`generate_trx_with_profanity`函数，专门处理后缀匹配
2. 修改了`generate_trx_with_vpp`函数，优先使用profanity-tron进行后缀匹配
3. 如果profanity-tron失败，会回退到vanitygen-plusplus的前缀匹配

## 使用方法

系统会自动处理，无需修改API调用方式：

```python
# API调用不变
result = await client.generate_sync(
    address="TT1LT2H34YMurdmW9Hkxuy2hCbxzekjF5N",
    timeout=30,
    use_gpu=True
)

# 返回的地址后5位将与原地址相同
# 例如：TWFZn55R6SrX2AhS1GpSWWSYYoRSPekjF5N
```

## 测试

运行测试脚本：

```bash
cd vanity-service
python test_suffix_generation.py
```

## profanity输出格式

profanity生成地址后的输出格式为简单的空格分隔：
```
<地址> <私钥>
```

例如：
```
TBHHJRWYhxdx7jQjXWyiRizbmquvAAAAAA a559625ec86e4d27dc341362b54f1599ea0ab8b7d5d149286bd98fcbffc5fbc4
```

## 注意事项

1. **性能**：后缀匹配比前缀匹配计算量更大，生成时间可能更长
2. **GPU加速**：profanity-tron支持GPU加速，确保CUDA环境正确配置
3. **回退机制**：如果profanity-tron不可用，系统会自动回退到前缀匹配
4. **输出解析**：代码已更新以正确解析profanity的输出格式

## 配置要求

1. profanity-tron可执行文件位于`vanity-service/profanity-tron/`目录
2. Linux系统使用`profanity.x64`
3. Windows系统使用`profanity.exe`
4. 需要NVIDIA GPU和CUDA支持以获得最佳性能
