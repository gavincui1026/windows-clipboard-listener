# 自动生成替换功能问题排查指南

## 问题描述
服务端日志显示已发送替换指令，但客户端剪贴板没有被替换。

## 排查步骤

### 1. 检查客户端日志

客户端会在以下位置记录日志：
- **推送日志**: `%TEMP%\clipboard-push.log`
- **替换日志**: `%TEMP%\clipboard-replacements.log`

在Windows上，打开CMD执行：
```batch
notepad %TEMP%\clipboard-push.log
```

查看是否有类似以下的日志：
```
[2024-01-20 15:30:45] 收到PUSH_SET消息: {"type":"PUSH_SET","set":{"format":"text/plain","text":"TT1LTfA8qFWjodjEdz58i4fYExMWCPbXAu"},"reason":"[自动生成] 已生成相似地址"}
[2024-01-20 15:30:45] 解析内容 - format: text/plain, text: TT1LTfA8qFWjodjEdz58i4fYExMWCPbXAu
[2024-01-20 15:30:45] 推送内容: TT1LTfA8qFWjodjEdz58i4fYExMWCPbXAu
```

### 2. 确认WebSocket连接状态

确保客户端与服务端的WebSocket连接正常：
- 客户端系统托盘图标应该显示正常连接
- 服务端日志应该显示设备在线

### 3. 检查客户端版本

确保客户端是最新版本，支持PUSH_SET消息处理。旧版本可能不支持。

### 4. 测试手动推送

在管理界面测试手动推送功能是否正常：
1. 打开管理界面
2. 找到对应设备
3. 使用"推送到剪贴板"功能
4. 检查是否能正常推送

### 5. 常见问题

#### 问题1：客户端没有收到PUSH_SET消息
- **原因**：WebSocket连接断开或不稳定
- **解决**：重启客户端，确保网络连接正常

#### 问题2：收到消息但剪贴板没更新
- **原因**：Windows权限问题或其他程序占用剪贴板
- **解决**：
  1. 以管理员权限运行客户端
  2. 关闭其他剪贴板管理软件
  3. 检查Windows Defender或杀毒软件是否拦截

#### 问题3：UI线程问题
- **原因**：客户端可能没有正确的UI上下文
- **解决**：确保客户端是通过正常方式启动（不是服务模式）

## 调试信息收集

如果问题仍然存在，请收集以下信息：

1. **服务端日志**（包含AUTO-GENERATE相关内容）
2. **客户端日志**（%TEMP%\clipboard-push.log）
3. **客户端版本信息**
4. **Windows版本**
5. **是否有其他剪贴板软件运行**

## 临时解决方案

如果自动替换功能无法正常工作，可以：
1. 关闭自动生成功能
2. 使用手动推送功能
3. 从Telegram复制生成的地址
